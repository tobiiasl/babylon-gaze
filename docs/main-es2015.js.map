{"version":3,"sources":["./src/app/engine/engine.component.ts","./src/app/engine/engine.component.html","./src/environments/environment.ts","./src/app/mock/document.mock.ts","./src/app/mock/window.mock.ts","./src/app/app.component.ts","./src/app/app.component.html","./src/app/mock/storage.mock.ts","./src/app/gaze.ts","./src/app/app.module.ts","./src/app/services/window-ref.service.ts","./src/app/engine/engine.service.ts","./src/main.ts","./$_lazy_route_resource lazy namespace object"],"names":[],"mappings":"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","file":"main-es2015.js","sourcesContent":["import { Component, ElementRef, OnInit, ViewChild } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport {getGaze} from '../gaze';\nimport { EngineService } from './engine.service';\n\n@Component({\n  selector: 'app-engine',\n  templateUrl: './engine.component.html'\n})\nexport class EngineComponent implements OnInit {\n\n  @ViewChild('rendererCanvas', { static: true })\n  public rendererCanvas: ElementRef<HTMLCanvasElement>;\n\n  public constructor(private engServ: EngineService,\n    // private route: ActivatedRoute\n    ) { }\n\n  public ngOnInit(): void {\n    const path = window.location.pathname;\n    const host = path.split('/').pop();\n    if(host.length === 0) {\n      console.error('No RU host name specified. Add e.g. /tg03b-080200100361.local or /192.168.75.51 to the url ');\n    }\n\n    console.log(`Connecting to \"${host}\"`);\n\n    this.engServ.createScene(this.rendererCanvas, host);\n    this.engServ.animate();\n  }\n}\n","<div class=\"engine-wrapper\">\n  <canvas #rendererCanvas id=\"renderCanvas\"></canvas>\n</div>\n","// The file contents for the current environment will overwrite these during build.\n// The build system defaults to the dev environment which uses `environment.ts`, but if you do\n// `ng build --env=prod` then `environment.prod.ts` will be used instead.\n// The list of which env maps to which file can be found in `.angular-cli.json`.\n\nexport const environment = {\n  production: false,\n  version: require('../../package.json').version\n};\n","export class DocumentMock extends Document {\n  public readyState: DocumentReadyState = 'loading';\n}\n","import { DocumentMock } from './document.mock';\nimport { StorageMock } from './storage.mock';\n\nexport class WindowMock extends Window {\n  public document = new DocumentMock();\n  public localStorage = new StorageMock();\n  public sessionStorage = new StorageMock();\n}\n","import { Component } from '@angular/core';\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html'\n})\nexport class AppComponent {}\n","<app-engine></app-engine>\n","export class StorageMock implements Storage {\n  public length = 0;\n  public clear(): void { return null; }\n  public getItem(key: string): string { return null; }\n  public key(index: number): string { return null; }\n  public removeItem(key: string): void { return null; }\n  public setItem(key: string, value: string): void { return null; }\n}\n","import {Observable, Subject} from 'rxjs';\nimport {filter, map} from 'rxjs/operators';\n\nexport const getGaze = function(host: string): Observable<any> {\n  const ws = new WebSocket(`ws://${host}/websocket`, 'g3api');\n  const gaze$ = new Subject();\n  const keepaliveMsg = JSON.stringify({method: 'POST', id: 2, path: '//rudimentary!keepalive','body':[]});\n  let intervalId: any;\n  ws.addEventListener('open', () => {\n    ws.send(JSON.stringify({method: 'POST', id: 1, path: '//rudimentary:gaze', body: null}));\n    let signalId: number;\n    ws.addEventListener('close', () => {\n      clearInterval(intervalId);\n    });\n    ws.addEventListener('message', (msg2: MessageEvent<any>) => {\n      signalId = JSON.parse(msg2.data)['body'];\n      intervalId = setInterval(() => ws.send(keepaliveMsg), 3000);\n      ws.addEventListener('message', (msg: MessageEvent<any>) => {\n        const data = JSON.parse(msg.data);\n        if (data.signal === signalId) {\n          gaze$.next(data.body[1]);\n        }\n      });\n    }, {once: true});\n  });\n  return gaze$.pipe(\n    filter((obj) => Object.keys(obj).length > 0),\n    map((gaze: any) => gaze.gaze3d)\n  );\n}\n","import { WindowRefService } from './services/window-ref.service';\nimport { NgModule } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\nimport { BrowserModule } from '@angular/platform-browser';\nimport { AppComponent } from './app.component';\nimport { EngineComponent } from './engine/engine.component';\n\n@NgModule({\n  declarations: [\n    AppComponent,\n    EngineComponent,\n  ],\n  imports: [\n    BrowserModule,\n    FormsModule\n  ],\n  providers: [\n    WindowRefService\n  ],\n  bootstrap: [\n    AppComponent\n  ]\n})\nexport class AppModule { }\n","import { Injectable } from '@angular/core';\nimport { WindowMock } from '../mock/window.mock';\n\nconst getWindow = (): Window => window != null ? window : new WindowMock();\n\n@Injectable()\nexport class WindowRefService {\n  private readonly windowObject: Window;\n\n  public constructor() {\n    this.windowObject = getWindow();\n  }\n\n  public get window(): Window {\n    return this.windowObject;\n  }\n\n  public get document(): Document {\n    return this.window.document;\n  }\n\n  public get localStore(): Storage {\n    return this.window.localStorage;\n  }\n\n  public get sessionStorage(): Storage {\n    return this.window.sessionStorage;\n  }\n}\n","import { WindowRefService } from './../services/window-ref.service';\nimport {ElementRef, Injectable, NgZone} from '@angular/core';\nimport {\n  Engine,\n  FreeCamera,\n  Scene,\n  Light,\n  Mesh,\n  MeshBuilder,\n  Color3,\n  Vector3,\n  HemisphericLight,\n  StandardMaterial,\n  DynamicTexture,\n} from '@babylonjs/core';\nimport {getGaze} from '../gaze';\n\ninterface EyePair {\n  left: Mesh;\n  right: Mesh;\n}\n@Injectable({ providedIn: 'root' })\nexport class EngineService {\n  private canvas: HTMLCanvasElement;\n  private engine: Engine;\n  private camera: FreeCamera;\n  private scene: Scene;\n  private light: Light;\n\n  private sphere: Mesh;\n\n  public constructor(\n    private ngZone: NgZone,\n    private windowRef: WindowRefService\n  ) {}\n\n\n  public createScene(canvas: ElementRef<HTMLCanvasElement>, host: string): void {\n    // The first step is to get the reference of the canvas element    from our HTML document\n    this.canvas = canvas.nativeElement;\n\n    // Then, load the Babylon 3D engine:\n    this.engine = new Engine(this.canvas,  true);\n\n    // This creates a basic Babylon Scene object (non-mesh)\n    this.scene = new Scene(this.engine);\n\n    // This creates and positions a free camera (non-mesh)\n    this.camera = new FreeCamera(\"camera1\", new Vector3(0, 0, -20), this.scene);\n\n    // This targets the camera to scene origin\n    this.camera.setTarget(Vector3.Zero());\n\n    // This attaches the camera to the canvas\n    this.camera.attachControl(canvas, true);\n\n    // This creates a light, aiming 0,1,0 - to the sky (non-mesh)\n    var light = new HemisphericLight(\"light1\", new Vector3(-1, 1, -1), this.scene);\n\n    // Default intensity is 1. Let's dim the light a small amount\n    light.intensity = 1;\n\n    var eyes1 = this.createEyePair(new Color3(0, 0.85, 1), this.scene);\n\n    this.eyesSetPosition(eyes1, new Vector3(0, 0, 0));\n\n    let flyposition = new Vector3(0, 0, -10);\n\n    const scaleFactor = 1.7 / 59;\n\n    getGaze(host).subscribe(\n      (gaze: any) => {\n        flyposition = new Vector3(gaze[0], gaze[1], -gaze[2]).scale(scaleFactor);\n      }\n    );\n\n    var index = 0;\n    setInterval(() => {\n      index++;\n      var speed = 0.3;\n      this.eyesLookAt(eyes1, flyposition);\n    }, 1000/60);\n  }\n\n  public eyesSetPosition(eyes: EyePair, position: Vector3) {\n      var origoDistance = Math.abs(eyes.left.position.x - eyes.right.position.x);\n      var leftX = position.x - origoDistance / 2;\n      var rightX = position.x + origoDistance / 2;\n\n      eyes.left.position = new Vector3(leftX, position.y, position.z);\n      eyes.right.position = new Vector3(rightX, position.y, position.z);\n  }\n\n  public eyesLookAt(eyes: EyePair, point: Vector3) {\n      this.eyeLookAt(eyes.left, point);\n      this.eyeLookAt(eyes.right, point);\n  }\n\n  public eyeLookAt(eye: Mesh, point: Vector3) {\n      var gazeVector = point.subtract(eye.position);\n      var alpha = Math.atan2(gazeVector.y, -gazeVector.z);\n      var beta = Math.atan2(gazeVector.x, -gazeVector.z);\n\n      eye.rotation = new Vector3(alpha, -beta);\n  }\n\n  public createEye(color: Color3, radius: number, scene: Scene): Mesh {\n      var eyeball = MeshBuilder.CreateSphere(\"eyeball\", {diameter: 2 * radius, segments: 16}, scene);\n\n      // const eyeballmaterial = new CellMaterial(\"eyeballmaterial\", scene);\n      const eyeballmaterial = new StandardMaterial(\"eyeballmaterial\", scene);\n      eyeballmaterial.diffuseColor = Color3.White();\n      eyeball.material = eyeballmaterial;\n\n      var iris = MeshBuilder.CreateSphere(\"pupil\", {diameter: 2* 0.4 * radius, segments: 8}, scene);\n      iris.position.z = -radius*.97;\n      iris.scaling.z = 0.05;  // Make it flat\n\n      const irismaterial = new StandardMaterial(\"irismaterial\", scene);\n      irismaterial.diffuseColor = color;\n      iris.material = irismaterial;\n\n      var pupil = MeshBuilder.CreateSphere(\"pupil\", {diameter: 2* 0.2 * radius, segments: 16}, scene);\n      pupil.position.z = -radius*1;\n      pupil.scaling.z = 0.1;  // Make it flat\n\n      const pupilmaterial = new StandardMaterial(\"pupilmaterial\", scene);\n      pupilmaterial.disableLighting = true;\n      pupilmaterial.diffuseColor = Color3.Black();\n      pupil.material = pupilmaterial;\n\n      var eye = Mesh.MergeMeshes([eyeball, iris, pupil], true, true, undefined, false, true);\n      return eye;\n  }\n\n  public createEyePair(color: Color3, scene: Scene) : EyePair {\n      var radius = 1;\n      var left = this.createEye(color, radius, scene);\n      var right = this.createEye(color, radius, scene);\n\n      var distanceBetweenEyes = 1.7 * radius;\n      left.position.x = -distanceBetweenEyes;\n      right.position.x = distanceBetweenEyes;\n\n      return {left, right};\n  }\n\n  public animate(): void {\n    // We have to run this outside angular zones,\n    // because it could trigger heavy changeDetection cycles.\n    this.ngZone.runOutsideAngular(() => {\n      const rendererLoopCallback = () => {\n        this.scene.render();\n      };\n\n      if (this.windowRef.document.readyState !== 'loading') {\n        this.engine.runRenderLoop(rendererLoopCallback);\n      } else {\n        this.windowRef.window.addEventListener('DOMContentLoaded', () => {\n          this.engine.runRenderLoop(rendererLoopCallback);\n        });\n      }\n\n      this.windowRef.window.addEventListener('resize', () => {\n        this.engine.resize();\n      });\n    });\n  }\n\n}\n","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.error(err));\n","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"zn8P\";"],"sourceRoot":"webpack:///"}